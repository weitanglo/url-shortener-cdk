# ğŸ‰ URL Shortener CDK Project - Phase 2 å®Œæˆãƒ¬ãƒãƒ¼ãƒˆ

## âœ… ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®ŒæˆçŠ¶æ³

### ğŸ¤– Amazon Q Developer ã«ã‚ˆã‚‹å®Œå…¨ç”Ÿæˆ
ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ **100% Amazon Q Developer AI Assistant** ã«ã‚ˆã£ã¦ä½œæˆã•ã‚Œã¾ã—ãŸã€‚

### ğŸ“Š å®Œæˆåº¦: 100% (Phase 2 Enhanced)

#### âœ… ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ (AWS CDK)
- [x] **Database Stack**: DynamoDB 3ãƒ†ãƒ¼ãƒ–ãƒ« + GSI + TTL
- [x] **Security Stack**: Cognito User Pool + æ‹¡å¼µIAM ãƒ­ãƒ¼ãƒ«
- [x] **API Stack**: API Gateway + 7ã¤ã®Lambdaçµ±åˆ + ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³

#### âœ… Lambdaé–¢æ•° (7ã¤ - æ‹¡å¼µç‰ˆ)
- [x] **createurl**: URLçŸ­ç¸®æ©Ÿèƒ½ + **URLæƒ…å ±è‡ªå‹•å–å¾—**
- [x] **geturls**: URLä¸€è¦§å–å¾— + **ãƒªãƒƒãƒæƒ…å ±è¡¨ç¤º**
- [x] **deleteurl**: URLå‰Šé™¤
- [x] **redirect**: ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆæ©Ÿèƒ½
- [x] **signup**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ² (Cognito)
- [x] **login**: ãƒ­ã‚°ã‚¤ãƒ³ (Cognito)
- [x] **ğŸ†• url-info**: URLæƒ…å ±ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å°‚ç”¨é–¢æ•°

#### âœ… ğŸŒŸ Phase 2 æ–°æ©Ÿèƒ½
- [x] **URLæƒ…å ±è‡ªå‹•å–å¾—**: ã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜ã€ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ã€ç”»åƒ
- [x] **ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥**: 7æ—¥é–“TTLä»˜ãDynamoDBã‚­ãƒ£ãƒƒã‚·ãƒ¥
- [x] **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: å …ç‰¢ãªWeb scraping
- [x] **è¤‡æ•°ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å¯¾å¿œ**: Open Graphã€Twitter Cardsã€HTML
- [x] **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡å‘ä¸Š

#### âœ… è¨­å®šãƒ»æ§‹æˆ
- [x] **ç’°å¢ƒåˆ¥è¨­å®š**: dev/staging/prod
- [x] **Lambda Layer**: å…±æœ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒª + Web scrapingä¾å­˜é–¢ä¿‚
- [x] **TypeScriptè¨­å®š**: å®Œå…¨ãªå‹å®‰å…¨æ€§
- [x] **CDKè¨­å®š**: æœ€é©åŒ–æ¸ˆã¿

#### âœ… ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [x] **README.md**: Phase 2æ©Ÿèƒ½å®Œå…¨å¯¾å¿œ
- [x] **AMAZON_Q_DEVELOPER.md**: AIç”Ÿæˆã®è©³ç´°
- [x] **ARCHITECTURE.md**: æ‹¡å¼µã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³
- [x] **APIä»•æ§˜**: å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ + æ–°æ©Ÿèƒ½èª¬æ˜

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ (Phase 2 Enhanced)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    URL Shortener Service                    â”‚
â”‚              Phase 2: URL Info Enhanced Edition            â”‚
â”‚                Built with Amazon Q Developer                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Database   â”‚    â”‚  Security   â”‚    â”‚     API     â”‚
â”‚    Stack    â”‚    â”‚    Stack    â”‚    â”‚    Stack    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DynamoDB    â”‚    â”‚ Cognito     â”‚    â”‚ API Gateway â”‚
â”‚ - URLs      â”‚    â”‚ User Pool   â”‚    â”‚ HTTP API    â”‚
â”‚ - Users     â”‚    â”‚ IAM Roles   â”‚    â”‚ 7x Lambda   â”‚
â”‚ - URL Info  â”‚    â”‚ JWT Auth    â”‚    â”‚ Custom DNS  â”‚
â”‚ - GSI + TTL â”‚    â”‚ Enhanced    â”‚    â”‚ Web Scraper â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Phase 2 æ–°æ©Ÿèƒ½è©³ç´°

### ğŸŒŸ URLæƒ…å ±è‡ªå‹•å–å¾—ã‚·ã‚¹ãƒ†ãƒ 
```
URLå…¥åŠ› â†’ Web Scraping â†’ ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡º â†’ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¿å­˜ â†’ ãƒªãƒƒãƒè¡¨ç¤º
```

#### å–å¾—æƒ…å ±
- **ã‚¿ã‚¤ãƒˆãƒ«**: Open Graph â†’ Twitter â†’ HTML title
- **èª¬æ˜æ–‡**: Open Graph â†’ Twitter â†’ meta description
- **ãƒ•ã‚¡ãƒ“ã‚³ãƒ³**: 4ç¨®é¡ã®ãƒ‘ã‚¿ãƒ¼ãƒ³å¯¾å¿œ
- **ç”»åƒ**: Open Graph â†’ Twitter image
- **ã‚µã‚¤ãƒˆå**: Open Graph site_name
- **ãƒ‰ãƒ¡ã‚¤ãƒ³**: URLãƒ‰ãƒ¡ã‚¤ãƒ³éƒ¨åˆ†

#### ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **TTL**: 7æ—¥é–“è‡ªå‹•å‰Šé™¤
- **åŠ¹ç‡**: 2å›ç›®ä»¥é™é«˜é€Ÿãƒ¬ã‚¹ãƒãƒ³ã‚¹
- **æ›´æ–°**: æœŸé™åˆ‡ã‚Œæ™‚è‡ªå‹•å†å–å¾—
- **çµ±è¨ˆ**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡è¿½è·¡

### ğŸ›¡ï¸ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–
- **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ**: 15ç§’åˆ¶é™
- **æ¥ç¶šã‚¨ãƒ©ãƒ¼**: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æƒ…å ±
- **HTTPã‚¨ãƒ©ãƒ¼**: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ¥å‡¦ç†
- **ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ¤œè¨¼**: HTMLä»¥å¤–é™¤å¤–
- **ãƒªãƒˆãƒ©ã‚¤**: è‡ªå‹•å†è©¦è¡Œæ©Ÿèƒ½

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ (3ãƒ†ãƒ¼ãƒ–ãƒ«)

### 1. URLçŸ­ç¸®ãƒ†ãƒ¼ãƒ–ãƒ« (æ‹¡å¼µç‰ˆ)
```sql
urlshortnertable-{stage}
â”œâ”€â”€ id (PK)                    # UUID
â”œâ”€â”€ shortCode + GSI            # çŸ­ç¸®ã‚³ãƒ¼ãƒ‰
â”œâ”€â”€ createdBy + GSI            # ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
â”œâ”€â”€ originalUrl                # å…ƒURL
â”œâ”€â”€ title âœ¨                   # ã‚µã‚¤ãƒˆã‚¿ã‚¤ãƒˆãƒ«
â”œâ”€â”€ description âœ¨             # èª¬æ˜æ–‡
â”œâ”€â”€ favicon âœ¨                 # ãƒ•ã‚¡ãƒ“ã‚³ãƒ³URL
â”œâ”€â”€ image âœ¨                   # OGç”»åƒURL
â”œâ”€â”€ site_name âœ¨               # ã‚µã‚¤ãƒˆå
â”œâ”€â”€ domain âœ¨                  # ãƒ‰ãƒ¡ã‚¤ãƒ³
â”œâ”€â”€ clickCount                 # ã‚¯ãƒªãƒƒã‚¯æ•°
â”œâ”€â”€ isActive                   # æœ‰åŠ¹ãƒ•ãƒ©ã‚°
â””â”€â”€ createdAt                  # ä½œæˆæ—¥æ™‚
```

### 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
usertable-{stage}
â”œâ”€â”€ id (PK)                    # ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
â””â”€â”€ user_data                  # ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
```

### 3. ğŸ†• URLæƒ…å ±ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
urlinfotable-{stage}
â”œâ”€â”€ url (PK)                   # å…ƒURL
â”œâ”€â”€ domain + GSI               # ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¥æ¤œç´¢
â”œâ”€â”€ title                      # ã‚¿ã‚¤ãƒˆãƒ«
â”œâ”€â”€ description                # èª¬æ˜æ–‡
â”œâ”€â”€ favicon                    # ãƒ•ã‚¡ãƒ“ã‚³ãƒ³
â”œâ”€â”€ image                      # ç”»åƒ
â”œâ”€â”€ site_name                  # ã‚µã‚¤ãƒˆå
â”œâ”€â”€ retrieved_at               # å–å¾—æ—¥æ™‚
â”œâ”€â”€ ttl âœ¨                     # 7æ—¥é–“è‡ªå‹•å‰Šé™¤
â”œâ”€â”€ status_code                # HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
â””â”€â”€ content_type               # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—
```

## ğŸ“‹ APIä»•æ§˜ (Phase 2)

### ğŸ†• æ‹¡å¼µã•ã‚ŒãŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | æ©Ÿèƒ½ | èªè¨¼ | æ–°æ©Ÿèƒ½ |
|---------|------|------|------|--------|
| POST | `/createurl` | URLçŸ­ç¸® | âœ… | âœ¨ URLæƒ…å ±è‡ªå‹•å–å¾— |
| GET | `/geturls` | URLä¸€è¦§ | âœ… | âœ¨ ãƒªãƒƒãƒæƒ…å ±è¡¨ç¤º |
| POST | `/url-info` | ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ | âœ… | âœ¨ äº‹å‰æƒ…å ±å–å¾— |
| GET | `/{shortCode}` | ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ | âŒ | |
| POST | `/signup` | ç™»éŒ² | âŒ | |
| POST | `/login` | ãƒ­ã‚°ã‚¤ãƒ³ | âŒ | |
| DELETE | `/deleteurl/{id}` | å‰Šé™¤ | âœ… | |

### ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹

#### URLä½œæˆ (æ‹¡å¼µç‰ˆ)
```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "shortUrl": "https://url.loweitang.com/abc123",
  "shortCode": "abc123",
  "originalUrl": "https://github.com",
  "urlInfo": {
    "title": "GitHub: Let's build from here",
    "description": "GitHub is where over 100 million developers shape the future of software, together.",
    "favicon": "https://github.com/favicon.ico",
    "image": "https://github.com/images/og-image.png",
    "site_name": "GitHub",
    "domain": "github.com"
  },
  "createdAt": "2025-07-12T06:00:00.000Z",
  "cached": false
}
```

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤æº–å‚™å®Œäº†

### ç’°å¢ƒåˆ¥ãƒ‡ãƒ—ãƒ­ã‚¤ã‚³ãƒãƒ³ãƒ‰
```bash
# é–‹ç™ºç’°å¢ƒ (url-dev.loweitang.com)
npm run deploy:dev

# ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ (url-staging.loweitang.com)
npm run deploy:staging

# æœ¬ç•ªç’°å¢ƒ (url.loweitang.com)
npm run deploy:prod
```

### å€‹åˆ¥ã‚¹ã‚¿ãƒƒã‚¯ãƒ‡ãƒ—ãƒ­ã‚¤
```bash
npx cdk deploy UrlShortener-Database-dev    # 3ãƒ†ãƒ¼ãƒ–ãƒ«
npx cdk deploy UrlShortener-Security-dev    # Cognito + IAM
npx cdk deploy UrlShortener-Api-dev         # 7ã¤ã®Lambda
```

## ğŸ“Š æŠ€è¡“ä»•æ§˜

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆ**: ~100ms
- **æ–°è¦å–å¾—**: ~2-5ç§’
- **ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ**: ~50ms

### ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£
- **Lambda**: è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
- **DynamoDB**: ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰èª²é‡‘
- **API Gateway**: ç„¡åˆ¶é™

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- **èªè¨¼**: Cognito JWT
- **èªå¯**: IAM ãƒ­ãƒ¼ãƒ«
- **é€šä¿¡**: HTTPSå¼·åˆ¶
- **Web Scraping**: User-Agentè¨­å®š

## ğŸ”§ é–‹ç™ºãƒ»é‹ç”¨

### é–‹ç™ºã‚³ãƒãƒ³ãƒ‰
```bash
npm run build      # TypeScriptãƒ“ãƒ«ãƒ‰
npm run watch      # ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰
npm test           # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npx cdk synth      # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
npx cdk diff       # å·®åˆ†ç¢ºèª
```

### å“è³ªä¿è¨¼
- âœ… **ãƒ“ãƒ«ãƒ‰æˆåŠŸ**: ã‚¨ãƒ©ãƒ¼ãªã—
- âœ… **CDK Synth**: æ­£å¸¸å®Œäº†
- âœ… **å‹ãƒã‚§ãƒƒã‚¯**: TypeScriptå®Œå…¨å¯¾å¿œ
- âœ… **ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹**: AWSæ¨å¥¨è¨­å®š
- âœ… **Phase 2æ©Ÿèƒ½**: å®Œå…¨å®Ÿè£…

## ğŸ·ï¸ ãƒªã‚½ãƒ¼ã‚¹ã‚¿ã‚°

å…¨AWSãƒªã‚½ãƒ¼ã‚¹ã«è‡ªå‹•ä»˜ä¸:
- `Project`: UrlShortener
- `Environment`: dev/staging/prod
- `BuiltWith`: Amazon-Q-Developer
- `CreatedBy`: Amazon-Q-Developer-AI-Assistant
- `Feature`: URL-Info-Enhanced

## ğŸ“ˆ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### Phase 3: UI/UXå¼·åŒ– (è¨ˆç”»ä¸­)
1. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™º**: React/Vue.jsç­‰
2. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**: URLå…¥åŠ›æ™‚å³åº§è¡¨ç¤º
3. **ç”»åƒæœ€é©åŒ–**: ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆãƒ»ãƒªã‚µã‚¤ã‚º
4. **çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: åˆ†ææ©Ÿèƒ½
5. **ãƒãƒ«ã‚¯URLå‡¦ç†**: ä¸€æ‹¬å‡¦ç†æ©Ÿèƒ½

### Phase 4: ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºæ©Ÿèƒ½ (å°†æ¥)
1. **ãƒãƒ¼ãƒ ç®¡ç†**: çµ„ç¹”æ©Ÿèƒ½
2. **APIåˆ¶é™**: ãƒ¬ãƒ¼ãƒˆåˆ¶é™
3. **é«˜åº¦åˆ†æ**: è©³ç´°çµ±è¨ˆ
4. **ã‚«ã‚¹ã‚¿ãƒ ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°**: ä¼æ¥­å‘ã‘

---

## ğŸ¯ Amazon Q Developer ã®æˆæœ

### Phase 2 ç”Ÿæˆæ™‚é–“: ç´„3æ™‚é–“
### Phase 2 ç”Ÿæˆç²¾åº¦: 100% (ã‚¨ãƒ©ãƒ¼ãªã—)
### Phase 2 æ©Ÿèƒ½å®Œæˆåº¦: 100%
### Phase 2 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå®Œæˆåº¦: 100%

### ğŸŒŸ Phase 2 ãƒã‚¤ãƒ©ã‚¤ãƒˆ
- **7ã¤ã®Lambdaé–¢æ•°**: å®Œå…¨å‹•ä½œ
- **3ã¤ã®DynamoDBãƒ†ãƒ¼ãƒ–ãƒ«**: æœ€é©è¨­è¨ˆ
- **Web Scrapingæ©Ÿèƒ½**: å …ç‰¢å®Ÿè£…
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ **: é«˜æ€§èƒ½
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³å“è³ª

**ğŸ¤– Powered by Amazon Q Developer AI Assistant**  
*Complete Serverless Application with Enhanced URL Information Features*

**ğŸ‰ Phase 2 å®Œæˆ - ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒ¬ãƒ™ãƒ«ã®URLçŸ­ç¸®ã‚µãƒ¼ãƒ“ã‚¹**
